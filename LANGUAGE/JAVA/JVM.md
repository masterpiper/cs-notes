# 一些基础知识
## 实例化是什么意思？
将class对象进行赋值后的具体对象。

## 在JAVA语言中，Class的基本结构怎样的？
在.java文件中，一个对象的结构包括了：
- 属性：对象数据
- 方法：对象的行为
- 构造方法：实例化对象
- 内部类：在类中声明的类



# JVM工作概述
JVM将java文件编译成用字节码表示的class文件，class的执行不依赖具体平台。
在运行class文件时，JVM则将字节码一句一句的翻译为目标平台的机器语言从而执行。这就是为什么说java介于编译型和解型语言的原因。

![[Pasted image 20230315143937.png|300]]

![[Pasted image 20230315143956.png|300]]

java-->字节码，是编译的过程；字节码的执行则是一句一句解释的过程。

![[Pasted image 20230315143746.png|300]]

# JAVA编译运行

## 源码编译机制
![[Pasted image 20230315144320.png|400]]
最后生成的class信息：
-   结构信息，包括 class 文件格式版本号及各部分的数量与大小的信息。
-   元数据，对应于 Java 源码中声明与常量的信息。包含类/继承的超类/实现的接口的声明信息、域与方法声明信息和常量池。
-   方法信息，对应 Java 源码中语句和表达式对应的信息。包含字节码、异常处理器表、求值栈与局部变量区大小、求值栈的类型记录、调试符号信息。

## 类加载机制
[[Java#Reflection]] 
![[Pasted image 20230407132501.png|300]]
定义：将class文件加载到内存，并对数据校验、转换解析和初始化，最终形成一个可被JVM使用的java类型。
![[Pasted image 20230407134412.png|550]]

### 加载阶段：

1. 通过类全限定名获取该类二进制字节流
![[Pasted image 20230407114243.png|300]]
> 这里要用到类加载器：classloader
> BootStrap ClassLoader: 主要加载jdk目录中的lib目录内容
> Extendtion ClassLoader: 加载/ext/lib中的内容
> Application ClassLoader: 加载classpath所制定的内容，即：自己写的类
> 双亲委派机制：优先向上寻找上一层类加载器，即：自底向下遍历加载器。这样可以保证类永远只会被加载一次，并且可以用自定加载器来覆盖预定义加载器。

2. 将该字节流代表的静态存储结构转化为方法区的运行时数据结构。
3. 将类class文件读如内存，并为之创建一个java.lang.Class对象； 
> 当程序使用任何一个类时，系统会自动建立一java.lang.Class对象，作为这个类的各种数据访问入口。


### 连接阶段
**验证**
验证class文件格式，正确后交给JVM

**准备**
验证后，为加载到JVM的class对象预分配内存空间，并根据对象结构对对象默认赋值。
**使用final修饰的变量，会在准备阶段初始化。其他变量会在初始化阶段赋值**。

**解析**
解析阶段将符号引用替换为直接引用

**初始化**
执行构造方法

## 类运行机制



# 内存分配策略

# 垃圾回收机制

# javac编译

# JIT编译
